import{r as b,j as e,C as q,S as E,a as z,B as V,b as F,L as O,P as T,c as I,R as G}from"./chunks/index.CzENbDGc.js";const K=({bookmarks:r,onSearchResults:o,placeholder:i="Search bookmarks, categories, or describe what you're looking for...",className:c=""})=>{const[n,h]=b.useState(""),[x,m]=b.useState(!1),[f,y]=b.useState([]),[k,j]=b.useState([]),p=b.useRef(null),s=r||[];console.log("IntentSearch render:",{bookmarksLength:s.length,query:n,isFocused:x,className:c});const a={category:/\b(category|folder|space|group|type)\b/i,recent:/\b(recent|latest|new|today|yesterday)\b/i,favorite:/\b(favorite|starred|important|essential)\b/i,learning:/\b(learn|study|course|tutorial|education|training)\b/i,work:/\b(work|job|professional|business|productivity)\b/i,entertainment:/\b(fun|entertainment|game|video|music|social)\b/i,url:/\b(https?:\/\/|www\.|\.com|\.org|\.net)\b/i},d=t=>{if(!t.trim())return[];const l=[],S=t.toLowerCase(),C=[...new Set(s.map(w=>Array.isArray(w.category)?w.category.join("/"):w.category))].filter(w=>w.toLowerCase().includes(S)).slice(0,3);l.push(...C);const L=s.filter(w=>w.title.toLowerCase().includes(S)).map(w=>w.title).slice(0,2);return l.push(...L),a.learning.test(t)&&l.push("Learning courses","Programming tutorials","Study materials"),a.work.test(t)&&l.push("Work tools","Productivity apps","Business resources"),a.entertainment.test(t)&&l.push("Entertainment","Social media","Videos"),[...new Set(l)].slice(0,5)},N=t=>{const l=[];return a.category.test(t)&&l.push({type:"category",query:t,weight:.8}),a.recent.test(t)&&l.push({type:"recent",query:t,weight:.7}),a.favorite.test(t)&&l.push({type:"favorite",query:t,weight:.7}),a.learning.test(t)&&l.push({type:"learning",query:t,weight:.9}),a.work.test(t)&&l.push({type:"work",query:t,weight:.9}),a.entertainment.test(t)&&l.push({type:"entertainment",query:t,weight:.9}),a.url.test(t)&&l.push({type:"url",query:t,weight:.6}),t.trim()&&l.push({type:"title",query:t,weight:.5}),l},g=t=>{if(!t.trim())return o(s),s;const l=N(t),S=new Map;l.forEach(C=>{s.forEach(L=>{let w=0;const A=C.query.toLowerCase(),R=L.title.toLowerCase(),M=Array.isArray(L.category)?L.category.join("/").toLowerCase():L.category.toLowerCase(),H=L.url.toLowerCase();switch(C.type){case"category":M.includes(A)&&(w+=C.weight*2);break;case"title":R.includes(A)&&(w+=C.weight),R.startsWith(A)&&(w+=C.weight*.5);break;case"url":H.includes(A)&&(w+=C.weight);break;case"recent":L.categorizedAt&&Date.now()-L.categorizedAt<7*24*60*60*1e3&&(w+=C.weight);break;case"learning":(M.includes("learn")||M.includes("course")||M.includes("tutorial")||M.includes("education"))&&(w+=C.weight*1.5);break;case"work":(M.includes("work")||M.includes("business")||M.includes("productivity")||M.includes("professional"))&&(w+=C.weight*1.5);break;case"entertainment":(M.includes("entertainment")||M.includes("social")||M.includes("video")||M.includes("game"))&&(w+=C.weight*1.5);break}if(w>0){const P=S.get(L.id||L.url);(!P||w>P.score)&&S.set(L.id||L.url,{bookmark:L,score:w})}})});const W=Array.from(S.values()).sort((C,L)=>L.score-C.score).map(C=>C.bookmark);return o(W),W},B=t=>{h(t);const l=d(t);y(l),g(t),t.trim()&&!k.includes(t.trim())&&j(S=>[t.trim(),...S.slice(0,4)])},u=t=>{var l;h(t),y([]),g(t),(l=p.current)==null||l.blur()},v=t=>{var l;t.key==="Escape"&&(y([]),m(!1),(l=p.current)==null||l.blur())};return b.useEffect(()=>{o(s)},[s]),e.jsxs("div",{className:`relative ${c}`,style:{minHeight:"60px"},children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:p,type:"text",value:n,onChange:t=>B(t.target.value),onFocus:()=>m(!0),onBlur:()=>setTimeout(()=>m(!1),200),onKeyDown:v,placeholder:i,className:"liquid-search",style:{minHeight:"48px"}}),e.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),n&&e.jsx("button",{onClick:()=>B(""),className:"absolute right-12 top-1/2 transform -translate-y-1/2 p-1 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x&&(f.length>0||k.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 liquid-glass rounded-2xl p-2 z-50 max-h-80 overflow-y-auto",children:[k.length>0&&!n&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 px-3 py-2",children:"Recent Searches"}),k.map((t,l)=>e.jsxs("button",{onClick:()=>u(t),className:"w-full text-left px-3 py-2 rounded-xl text-sm text-slate-600 hover:bg-white/60 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:t})]},l))]}),f.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 px-3 py-2",children:"Suggestions"}),f.map((t,l)=>e.jsxs("button",{onClick:()=>u(t),className:"w-full text-left px-3 py-2 rounded-xl text-sm text-slate-600 hover:bg-white/60 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{children:t})]},l))]})]})]})},$=r=>{chrome.tabs.create({url:r.url})},_=r=>{const o=["blue","purple","green","orange","pink","indigo"],i=r.split("").reduce((c,n)=>c+n.charCodeAt(0),0);return o[i%o.length]},Z=r=>{const o=new Map;r.forEach(c=>{const h=(Array.isArray(c.category)?c.category.join("/"):c.category).split("/").filter(x=>x.trim()!=="");if(h.length===0)o.has("Uncategorized")||o.set("Uncategorized",{bookmarks:[],subcategories:new Map}),o.get("Uncategorized").bookmarks.push(c);else{const x=h[0];o.has(x)||o.set(x,{bookmarks:[],subcategories:new Map});const m=o.get(x);if(h.length===1)m.bookmarks.push(c);else{let f=m.subcategories;for(let y=1;y<h.length;y++){const k=h[y];y===h.length-1?(f.has(k)||f.set(k,{bookmarks:[],subcategories:new Map}),f.get(k).bookmarks.push(c)):(f.has(k)||f.set(k,{bookmarks:[],subcategories:new Map}),f=f.get(k).subcategories)}}}});const i=[];for(const[c,n]of o)i.push({category:c,bookmarks:n.bookmarks,subcategories:n.subcategories});return i},Y=async(r,o,i)=>{try{if(await q.remove(E.CATEGORIZED_BOOKMARKS),typeof chrome<"u"&&chrome.bookmarks){const c=await z.getAll();for(const n of c)if(n.id&&await z.isInCategorizedFolder(n))try{await chrome.bookmarks.remove(n.id),console.log(`Removed categorized bookmark: ${n.title}`)}catch(x){console.warn(`Failed to remove bookmark ${n.id}:`,x)}try{const h=(await chrome.bookmarks.getSubTree("1"))[0].id,m=(await chrome.bookmarks.getChildren(h)).find(f=>f.title==="ðŸ“š Categorized Bookmarks");m&&(await chrome.bookmarks.removeTree(m.id),console.log("Removed categorized bookmarks folder"))}catch(n){console.warn("Failed to remove categorized bookmarks folder:",n)}}r([]),o([]),await i(),console.log("Successfully cleared all categorized bookmarks")}catch(c){console.error("Error clearing all bookmarks:",c)}},D=r=>{try{return new URL(r).hostname.replace("www.","").split(".")[0]}catch{return"link"}},J=r=>{try{return`https://www.google.com/s2/favicons?domain=${new URL(r).hostname}&sz=32`}catch{return""}},X=r=>r?new Date(r).toLocaleDateString():"Unknown date",Q=({bookmarks:r,onBookmarkClick:o,className:i="",structure:c="nested"})=>{const[n,h]=b.useState([]),x=b.useMemo(()=>{const s=new Map;return r.forEach(a=>{const N=(Array.isArray(a.category)?a.category.join("/"):a.category).split("/").filter(g=>g.trim()!=="");if(N.length===0)s.has("Uncategorized")||s.set("Uncategorized",{id:"uncategorized",name:"Uncategorized",type:"folder",bookmarks:[],subfolders:new Map,path:"Uncategorized"}),s.get("Uncategorized").bookmarks.push(a);else{let g="",B=s;for(let u=0;u<N.length;u++){const v=N[u];g=g?`${g}/${v}`:v,B.has(v)||B.set(v,{id:g,name:v,type:"folder",bookmarks:[],subfolders:new Map,path:g});const t=B.get(v);u===N.length-1?t.bookmarks.push(a):(t.subfolders||(t.subfolders=new Map),B=t.subfolders)}}}),Array.from(s.values())},[r]),m=s=>{if(s===0)return x;if(s<=n.length){let a=x;for(let d=0;d<s;d++){const N=n[d],g=a.find(B=>B.name===N);if(g&&g.subfolders)a=Array.from(g.subfolders.values());else return[]}return a}return[]},f=()=>{if(n.length===0)return[];let s=x;for(let d=0;d<n.length-1;d++){const N=n[d],g=s.find(B=>B.name===N);if(g&&g.subfolders)s=Array.from(g.subfolders.values());else return[]}const a=s.find(d=>d.name===n[n.length-1]);return(a==null?void 0:a.bookmarks)||[]},y=(s,a)=>{const d=n.slice(0,a);d.push(s.name),h(d)},k=s=>{if(o)o(s);else try{typeof chrome<"u"&&chrome.tabs?chrome.tabs.create({url:s.url}):window.open(s.url,"_blank","noopener,noreferrer")}catch(a){console.error("Failed to open bookmark URL:",a),window.location.href=s.url}},j=[];for(let s=0;s<=n.length;s++){const a=m(s);a.length>0&&j.push(a)}const p=f();return e.jsxs("div",{className:`flex h-full overflow-x-auto ${i}`,children:[j.map((s,a)=>e.jsx("div",{className:`flex-shrink-0 border-r border-slate-200/50 bg-white/30 backdrop-blur-sm ${c==="flattened"?"w-64":p.length>0?"w-36":"w-48"}`,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-xs font-medium text-slate-700 mb-2 truncate",children:a===0?"Categories":n[a-1]||"Folder"}),e.jsx("div",{className:"space-y-1",children:s.map(d=>e.jsx("div",{children:e.jsx("button",{onClick:()=>y(d,a),className:`w-full text-left p-2 rounded-lg hover:bg-slate-100/60 transition-colors ${n[a]===d.name?"bg-blue-50 border border-blue-200":""}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[e.jsxs("svg",{className:"w-3 h-3 text-slate-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"})]}),e.jsx("span",{className:"text-xs font-medium text-slate-900 truncate",children:d.name}),d.bookmarks&&d.bookmarks.length>0&&e.jsx("span",{className:"text-xs text-slate-500 bg-slate-100 px-1.5 py-0.5 rounded-full flex-shrink-0",children:d.bookmarks.length})]}),d.subfolders&&d.subfolders.size>0||d.bookmarks&&d.bookmarks.length>0?e.jsx("svg",{className:"w-3 h-3 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):null]})})},d.id))})]})},a)),p.length>0&&e.jsx("div",{className:"flex-1 min-w-96 border-r border-slate-200/50 bg-white/30 backdrop-blur-sm",children:e.jsxs("div",{className:"p-4 h-full",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 mb-3",children:["Bookmarks (",p.length,")"]}),e.jsxs("div",{className:"grid grid-cols-12 gap-3 mb-3 px-3 py-2 text-xs font-medium text-slate-600 border-b border-slate-200/50",children:[e.jsx("div",{className:"col-span-4",children:"Title"}),e.jsx("div",{className:"col-span-5",children:"Summary"}),e.jsx("div",{className:"col-span-2",children:"Date Added"}),e.jsx("div",{className:"col-span-1",children:"ID"})]}),e.jsx("div",{className:"space-y-2 overflow-y-auto",style:{height:"calc(100% - 80px)"},children:p.map((s,a)=>e.jsxs("div",{onClick:()=>k(s),title:`Click to open: ${s.url}`,className:"group grid grid-cols-12 gap-3 p-3 rounded-lg hover:bg-slate-100/60 transition-colors cursor-pointer border border-transparent hover:border-slate-200",children:[e.jsxs("div",{className:"col-span-4 flex items-center space-x-2 min-w-0",children:[e.jsxs("div",{className:"flex-shrink-0 w-6 h-6 rounded bg-slate-100 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:J(s.url),alt:"",className:"w-4 h-4",onError:d=>{var g;const N=d.target;N.style.display="none",(g=N.nextElementSibling)==null||g.classList.remove("hidden")}}),e.jsx("div",{className:"hidden w-4 h-4 bg-gradient-to-br from-slate-400 to-slate-500 rounded flex items-center justify-center text-white text-xs font-medium",children:D(s.url).charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 truncate group-hover:text-blue-600 transition-colors",children:s.title}),e.jsx("div",{className:"text-xs text-slate-500 truncate",children:D(s.url)})]})]}),e.jsx("div",{className:"col-span-5 text-sm text-slate-600 line-clamp-2 leading-relaxed",children:s.summary||"-"}),e.jsx("div",{className:"col-span-2 text-sm text-slate-500 flex items-center",children:X(s.dateAdded)}),e.jsxs("div",{className:"col-span-1 text-sm font-mono text-slate-500 flex items-center justify-between",children:[e.jsx("span",{children:s.id?`#${s.id.slice(0,6)}`:"-"}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]},s.id||`${s.url}-${a}`))})]})})]})},ee=({settings:r,isLoading:o,onSync:i})=>e.jsx("div",{className:"liquid-glass border-b border-white/20 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 liquid-gradient-primary rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Bookmark Spaces"}),e.jsxs("p",{className:"text-slate-600",children:["Organized by ",r.persona]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx(V,{variant:"ghost",onClick:i,disabled:o,children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("title",{children:"Sync bookmarks"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.93 4.93a10 10 0 0114.14 0m0 0V1m0 3.93H17m-1.07 13.07a10 10 0 01-14.14 0m0 0V23m0-3.93H7"})]})})})]})})}),se=({uncategorizedCount:r,categorizedCount:o,spacesCount:i,isLoading:c,onCategorize:n,onClearAll:h})=>e.jsx("div",{className:"mb-8 space-y-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("div",{className:"liquid-card py-3 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Uncategorized"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:r})]})]})}),e.jsx("div",{className:"liquid-card py-3 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Categorized"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:o})]})]})}),e.jsx("div",{className:"liquid-card py-3 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Spaces"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:i})]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(V,{onClick:n,loading:c,disabled:r===0,children:c?"Categorizing...":`Categorize ${r} Bookmarks`}),e.jsx(V,{variant:"outline",onClick:h,disabled:o===0,children:"Clear All"})]})]})}),te=({viewMode:r,onViewModeChange:o})=>e.jsx("div",{className:"liquid-nav",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs("button",{onClick:()=>o("columns"),className:`liquid-nav-item ${r==="columns"?"active":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),e.jsx("span",{children:"Columns"})]}),e.jsxs("button",{onClick:()=>o("spaces"),className:`liquid-nav-item ${r==="spaces"?"active":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.jsx("span",{children:"Spaces"})]}),e.jsxs("button",{onClick:()=>o("list"),className:`liquid-nav-item ${r==="list"?"active":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),e.jsx("span",{children:"List"})]})]})}),re=({bookmarks:r,onBookmarkClick:o})=>e.jsx("div",{className:"liquid-card",children:e.jsx("div",{className:"space-y-3",children:r.map((i,c)=>e.jsxs("div",{onClick:()=>o(i),className:"flex items-center space-x-4 p-4 rounded-xl hover:bg-white/60 transition-all duration-200 cursor-pointer group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center",children:e.jsx("img",{src:`https://www.google.com/s2/favicons?domain=${new URL(i.url).hostname}&sz=32`,alt:"",className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 truncate group-hover:text-blue-600 transition-colors",children:i.title}),e.jsx("p",{className:"text-sm text-slate-500 truncate",children:i.url}),e.jsx("p",{className:"text-xs text-slate-400",children:i.category})]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]},i.id||`${i.url}-${c}`))})}),oe={blue:"from-blue-500/20 to-blue-600/20 text-blue-600",purple:"from-purple-500/20 to-purple-600/20 text-purple-600",green:"from-green-500/20 to-green-600/20 text-green-600",orange:"from-orange-500/20 to-orange-600/20 text-orange-600",pink:"from-pink-500/20 to-pink-600/20 text-pink-600",indigo:"from-indigo-500/20 to-indigo-600/20 text-indigo-600"},ae={blue:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),purple:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),green:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),orange:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),pink:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),indigo:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},U=({title:r,bookmarks:o,subcategories:i,icon:c,color:n="blue",onBookmarkClick:h,onSpaceClick:x,className:m="",level:f=0})=>{const[y,k]=b.useState(!1),[j,p]=b.useState(!1),s=()=>{k(!y),x==null||x()},a=u=>{h==null||h(u)},d=u=>{try{return new URL(u).hostname.replace("www.","").split(".")[0]}catch{return"link"}},N=u=>{try{return`https://www.google.com/s2/favicons?domain=${new URL(u).hostname}&sz=32`}catch{return""}},g=(u,v)=>{let t=u.length;if(v)for(const l of v.values())t+=g(l.bookmarks,l.subcategories);return t},B=g(o,i);return e.jsxs("div",{className:`liquid-space ${m} ${f>0?"ml-4 border-l-2 border-slate-200/50 pl-4":""}`,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[e.jsxs("div",{className:"liquid-space-header",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`liquid-space-icon bg-gradient-to-br ${oe[n]}`,children:c||ae[n]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:r}),e.jsxs("p",{className:"text-sm text-slate-500",children:[B," bookmarks"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:s,className:`p-2 rounded-xl transition-all duration-200 ${j?"bg-white/60 text-slate-600":"text-slate-400"}`,children:e.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]}),y&&e.jsxs("div",{className:"space-y-2 liquid-fade-in",children:[o.slice(0,5).map((u,v)=>e.jsxs("div",{onClick:()=>a(u),className:"group flex items-center space-x-3 p-3 rounded-xl hover:bg-white/60 transition-all duration-200 cursor-pointer",children:[e.jsxs("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:N(u.url),alt:"",className:"w-5 h-5",onError:t=>{var S;const l=t.target;l.style.display="none",(S=l.nextElementSibling)==null||S.classList.remove("hidden")}}),e.jsx("div",{className:"hidden w-5 h-5 bg-gradient-to-br from-slate-400 to-slate-500 rounded flex items-center justify-center text-white text-xs font-medium",children:d(u.url).charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-900 truncate group-hover:text-blue-600 transition-colors",children:u.title}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:d(u.url)})]}),e.jsx("div",{className:"flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]},u.id||`${u.url}-${v}`)),o.length>5&&e.jsx("div",{className:"text-center py-2",children:e.jsxs("span",{className:"text-xs text-slate-500",children:["+",o.length-5," more bookmarks"]})}),i&&Array.from(i.entries()).map(([u,v])=>e.jsx(U,{title:u,bookmarks:v.bookmarks,subcategories:v.subcategories,color:n,onBookmarkClick:h,level:f+1},u))]})]})},ne=({bookmarks:r,onBookmarkClick:o})=>{const i=Z(r);return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((c,n)=>e.jsx("div",{className:"liquid-scale-in",style:{animationDelay:`${n*100}ms`},children:e.jsx(U,{title:c.category,bookmarks:c.bookmarks,subcategories:c.subcategories,color:_(c.category),onBookmarkClick:o})},n))})},ie=({uncategorizedCount:r})=>e.jsxs("div",{className:"liquid-card text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 text-slate-400",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No bookmarks found"}),e.jsx("p",{className:"text-slate-600",children:r>0?`Click "Categorize Bookmarks" to organize your ${r} bookmarks.`:"All your bookmarks are already categorized!"})]}),le=()=>e.jsx("div",{className:"min-h-screen liquid-gradient-secondary flex items-center justify-center p-6",children:e.jsxs("div",{className:"liquid-card text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 liquid-gradient-primary rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Setup Required"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Please complete the setup in the extension popup first."}),e.jsx(V,{onClick:()=>window.close(),children:"Close"})]})}),ce=()=>{const[r,o]=b.useState(null),[i,c]=b.useState(!1),[n,h]=b.useState([]),[x,m]=b.useState([]),[f,y]=b.useState(0),[k,j]=b.useState(!1),p=async()=>{const s=await q.get(E.USER_SETTINGS);o(s);const a=await z.getValidCategorizedBookmarks();h(a),m(a);const d=await z.getUncategorized();y(d.length)};return b.useEffect(()=>{p();const s=async()=>{if(k){console.log("Skipping bookmark sync during categorization...");return}console.log("Bookmark changed, syncing with Chrome bookmarks...");try{await z.syncWithChromeBookmarks(),await p()}catch(a){console.error("Error syncing bookmarks:",a)}};return typeof chrome<"u"&&chrome.bookmarks&&(chrome.bookmarks.onCreated.addListener(s),chrome.bookmarks.onRemoved.addListener(s),chrome.bookmarks.onChanged.addListener(s),chrome.bookmarks.onMoved.addListener(s)),()=>{typeof chrome<"u"&&chrome.bookmarks&&(chrome.bookmarks.onCreated.removeListener(s),chrome.bookmarks.onRemoved.removeListener(s),chrome.bookmarks.onChanged.removeListener(s),chrome.bookmarks.onMoved.removeListener(s))}},[k]),{settings:r,isLoading:i,setIsLoading:c,allBookmarks:n,setAllBookmarks:h,filteredBookmarks:x,setFilteredBookmarks:m,uncategorizedCount:f,isCategorizing:k,setIsCategorizing:j,loadData:p}},de=(r,o,i,c)=>{const[n,h]=b.useState(!1),[x,m]=b.useState([]);return{previewOpen:n,previewBookmarks:x,handleCategorizeBookmarks:async()=>{if(r){o(!0),i(!0);try{const j=await z.getUncategorized();if(j.length===0){o(!1),i(!1);return}const p=await z.getBookmarksWithDescriptions(j),s=await F.categorize({persona:r.persona,bookmarks:p,structure:r.structure});if(s.error)throw new Error(s.error);s.data&&(m(s.data),h(!0))}catch(j){console.error("Categorization error:",j),o(!1),i(!1)}}},handleAcceptPreview:async()=>{h(!1),o(!0),i(!0);try{if(!r){o(!1),i(!1),m([]);return}const j=await q.get(E.CATEGORIZED_BOOKMARKS)||{};x.forEach(p=>{p.id&&(j[p.id]={bookmark:p,categorizedAt:Date.now()})}),await q.set(E.CATEGORIZED_BOOKMARKS,j),await z.organizeBookmarksInChrome(x,r.structure==="flattened"?"flatten":"nested"),await c(),await new Promise(p=>setTimeout(p,1e3))}catch(j){console.error("Error organizing bookmarks:",j)}finally{o(!1),i(!1),m([])}},handleDenyPreview:()=>{h(!1),o(!1),i(!1),m([])}}},he=()=>{const[r,o]=b.useState("columns"),{settings:i,isLoading:c,setIsLoading:n,allBookmarks:h,setAllBookmarks:x,filteredBookmarks:m,setFilteredBookmarks:f,uncategorizedCount:y,setIsCategorizing:k,loadData:j}=ce(),{previewOpen:p,previewBookmarks:s,handleCategorizeBookmarks:a,handleAcceptPreview:d,handleDenyPreview:N}=de(i,n,k,j),g=t=>{f(t)},B=async()=>{try{await j()}catch(t){console.error("Error syncing:",t)}},u=()=>{Y(x,f,j)};if(!i)return e.jsx(le,{});const v=m.length>0?m.reduce((t,l)=>{const S=Array.isArray(l.category)?l.category.join("/"):l.category;return t[S]||(t[S]=[]),t[S].push(l),t},{}):{};return console.log("All bookmarks:",h),console.log("Filtered bookmarks:",m),console.log("Bookmark groups:",v),e.jsxs("div",{className:"min-h-screen liquid-gradient-secondary",children:[e.jsx(ee,{settings:i,isLoading:c,onSync:B}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx(K,{bookmarks:h||[],onSearchResults:g,className:"w-full max-w-2xl"})}),e.jsx(se,{uncategorizedCount:y,categorizedCount:h.length,spacesCount:Object.keys(v).length,isLoading:c,onCategorize:a,onClearAll:u}),c&&e.jsxs("div",{className:"liquid-card text-center py-12",children:[e.jsx(O,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Analyzing your bookmarks and categorizing them..."})]}),!c&&e.jsx(e.Fragment,{children:m.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-900",children:[r==="spaces"?"Bookmark Spaces":"All Bookmarks"," (",m.length,")"]}),e.jsx(te,{viewMode:r,onViewModeChange:o})]}),r==="columns"?e.jsx("div",{className:"liquid-card h-96",children:e.jsx(Q,{bookmarks:m,onBookmarkClick:$,className:"h-full"})}):r==="spaces"?e.jsx(ne,{bookmarks:m,onBookmarkClick:$}):e.jsx(re,{bookmarks:m,onBookmarkClick:$})]}):e.jsx(ie,{uncategorizedCount:y})})]}),e.jsx(T,{isOpen:p,onAccept:d,onDeny:N,categorizedBookmarks:s})]})};function me(){return e.jsx("div",{className:"h-screen w-full",children:e.jsx(he,{})})}I.createRoot(document.getElementById("root")).render(e.jsx(G.StrictMode,{children:e.jsx(me,{})}));
