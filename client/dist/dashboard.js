import{r as g,j as e,C as F,S as D,a as V,B as I,L as K,P as G,b as _,c as Z,R as Y}from"./chunks/index.BVHNJ289.js";const J=({bookmarks:b,onSearchResults:C,placeholder:L="Search bookmarks, categories, or describe what you're looking for...",className:y=""})=>{const[h,B]=g.useState(""),[k,z]=g.useState(!1),[N,S]=g.useState([]),[j,E]=g.useState([]),A=g.useRef(null),x=b||[];console.log("IntentSearch render:",{bookmarksLength:x.length,query:h,isFocused:k,className:y});const v={category:/\b(category|folder|space|group|type)\b/i,recent:/\b(recent|latest|new|today|yesterday)\b/i,favorite:/\b(favorite|starred|important|essential)\b/i,learning:/\b(learn|study|course|tutorial|education|training)\b/i,work:/\b(work|job|professional|business|productivity)\b/i,entertainment:/\b(fun|entertainment|game|video|music|social)\b/i,url:/\b(https?:\/\/|www\.|\.com|\.org|\.net)\b/i},M=s=>{if(!s.trim())return[];const o=[],u=s.toLowerCase(),p=[...new Set(x.map(m=>Array.isArray(m.category)?m.category.join("/"):m.category))].filter(m=>m.toLowerCase().includes(u)).slice(0,3);o.push(...p);const f=x.filter(m=>m.title.toLowerCase().includes(u)).map(m=>m.title).slice(0,2);return o.push(...f),v.learning.test(s)&&o.push("Learning courses","Programming tutorials","Study materials"),v.work.test(s)&&o.push("Work tools","Productivity apps","Business resources"),v.entertainment.test(s)&&o.push("Entertainment","Social media","Videos"),[...new Set(o)].slice(0,5)},t=s=>{const o=[];return v.category.test(s)&&o.push({type:"category",query:s,weight:.8}),v.recent.test(s)&&o.push({type:"recent",query:s,weight:.7}),v.favorite.test(s)&&o.push({type:"favorite",query:s,weight:.7}),v.learning.test(s)&&o.push({type:"learning",query:s,weight:.9}),v.work.test(s)&&o.push({type:"work",query:s,weight:.9}),v.entertainment.test(s)&&o.push({type:"entertainment",query:s,weight:.9}),v.url.test(s)&&o.push({type:"url",query:s,weight:.6}),s.trim()&&o.push({type:"title",query:s,weight:.5}),o},a=s=>{if(!s.trim())return C(x),x;const o=t(s),u=new Map;o.forEach(p=>{x.forEach(f=>{let m=0;const r=p.query.toLowerCase(),n=f.title.toLowerCase(),d=Array.isArray(f.category)?f.category.join("/").toLowerCase():f.category.toLowerCase(),w=f.url.toLowerCase();switch(p.type){case"category":d.includes(r)&&(m+=p.weight*2);break;case"title":n.includes(r)&&(m+=p.weight),n.startsWith(r)&&(m+=p.weight*.5);break;case"url":w.includes(r)&&(m+=p.weight);break;case"recent":f.categorizedAt&&Date.now()-f.categorizedAt<7*24*60*60*1e3&&(m+=p.weight);break;case"learning":(d.includes("learn")||d.includes("course")||d.includes("tutorial")||d.includes("education"))&&(m+=p.weight*1.5);break;case"work":(d.includes("work")||d.includes("business")||d.includes("productivity")||d.includes("professional"))&&(m+=p.weight*1.5);break;case"entertainment":(d.includes("entertainment")||d.includes("social")||d.includes("video")||d.includes("game"))&&(m+=p.weight*1.5);break}if(m>0){const q=u.get(f.id||f.url);(!q||m>q.score)&&u.set(f.id||f.url,{bookmark:f,score:m})}})});const W=Array.from(u.values()).sort((p,f)=>f.score-p.score).map(p=>p.bookmark);return C(W),W},i=s=>{B(s);const o=M(s);S(o),a(s),s.trim()&&!j.includes(s.trim())&&E(u=>[s.trim(),...u.slice(0,4)])},l=s=>{var o;B(s),S([]),a(s),(o=A.current)==null||o.blur()},c=s=>{var o;s.key==="Escape"&&(S([]),z(!1),(o=A.current)==null||o.blur())};return g.useEffect(()=>{C(x)},[x]),e.jsxs("div",{className:`relative ${y}`,style:{minHeight:"60px"},children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:A,type:"text",value:h,onChange:s=>i(s.target.value),onFocus:()=>z(!0),onBlur:()=>setTimeout(()=>z(!1),200),onKeyDown:c,placeholder:L,className:"liquid-search",style:{minHeight:"48px"}}),e.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),h&&e.jsx("button",{onClick:()=>i(""),className:"absolute right-12 top-1/2 transform -translate-y-1/2 p-1 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),k&&(N.length>0||j.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 liquid-glass rounded-2xl p-2 z-50 max-h-80 overflow-y-auto",children:[j.length>0&&!h&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 px-3 py-2",children:"Recent Searches"}),j.map((s,o)=>e.jsxs("button",{onClick:()=>l(s),className:"w-full text-left px-3 py-2 rounded-xl text-sm text-slate-600 hover:bg-white/60 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:s})]},o))]}),N.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 px-3 py-2",children:"Suggestions"}),N.map((s,o)=>e.jsxs("button",{onClick:()=>l(s),className:"w-full text-left px-3 py-2 rounded-xl text-sm text-slate-600 hover:bg-white/60 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{children:s})]},o))]})]})]})},X={blue:"from-blue-500/20 to-blue-600/20 text-blue-600",purple:"from-purple-500/20 to-purple-600/20 text-purple-600",green:"from-green-500/20 to-green-600/20 text-green-600",orange:"from-orange-500/20 to-orange-600/20 text-orange-600",pink:"from-pink-500/20 to-pink-600/20 text-pink-600",indigo:"from-indigo-500/20 to-indigo-600/20 text-indigo-600"},Q={blue:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),purple:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),green:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),orange:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),pink:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),indigo:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},T=({title:b,bookmarks:C,subcategories:L,icon:y,color:h="blue",onBookmarkClick:B,onSpaceClick:k,className:z="",level:N=0})=>{const[S,j]=g.useState(!1),[E,A]=g.useState(!1),x=()=>{j(!S),k==null||k()},v=l=>{B==null||B(l)},M=l=>{try{return new URL(l).hostname.replace("www.","").split(".")[0]}catch{return"link"}},t=l=>{try{return`https://www.google.com/s2/favicons?domain=${new URL(l).hostname}&sz=32`}catch{return""}},a=(l,c)=>{let s=l.length;if(c)for(const o of c.values())s+=a(o.bookmarks,o.subcategories);return s},i=a(C,L);return e.jsxs("div",{className:`liquid-space ${z} ${N>0?"ml-4 border-l-2 border-slate-200/50 pl-4":""}`,onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),children:[e.jsxs("div",{className:"liquid-space-header",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`liquid-space-icon bg-gradient-to-br ${X[h]}`,children:y||Q[h]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:b}),e.jsxs("p",{className:"text-sm text-slate-500",children:[i," bookmarks"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:x,className:`p-2 rounded-xl transition-all duration-200 ${E?"bg-white/60 text-slate-600":"text-slate-400"}`,children:e.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${S?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]}),S&&e.jsxs("div",{className:"space-y-2 liquid-fade-in",children:[C.slice(0,5).map((l,c)=>e.jsxs("div",{onClick:()=>v(l),className:"group flex items-center space-x-3 p-3 rounded-xl hover:bg-white/60 transition-all duration-200 cursor-pointer",children:[e.jsxs("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:t(l.url),alt:"",className:"w-5 h-5",onError:s=>{var u;const o=s.target;o.style.display="none",(u=o.nextElementSibling)==null||u.classList.remove("hidden")}}),e.jsx("div",{className:"hidden w-5 h-5 bg-gradient-to-br from-slate-400 to-slate-500 rounded flex items-center justify-center text-white text-xs font-medium",children:M(l.url).charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-900 truncate group-hover:text-blue-600 transition-colors",children:l.title}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:M(l.url)})]}),e.jsx("div",{className:"flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]},l.id||`${l.url}-${c}`)),C.length>5&&e.jsx("div",{className:"text-center py-2",children:e.jsxs("span",{className:"text-xs text-slate-500",children:["+",C.length-5," more bookmarks"]})}),L&&Array.from(L.entries()).map(([l,c])=>e.jsx(T,{title:l,bookmarks:c.bookmarks,subcategories:c.subcategories,color:h,onBookmarkClick:B,level:N+1},l))]})]})},ee=({bookmarks:b,onBookmarkClick:C,className:L="",structure:y="nested"})=>{const[h,B]=g.useState([]),k=g.useMemo(()=>{const t=new Map;return b.forEach(a=>{const l=(Array.isArray(a.category)?a.category.join("/"):a.category).split("/").filter(c=>c.trim()!=="");if(l.length===0)t.has("Uncategorized")||t.set("Uncategorized",{id:"uncategorized",name:"Uncategorized",type:"folder",bookmarks:[],subfolders:new Map,path:"Uncategorized"}),t.get("Uncategorized").bookmarks.push(a);else{let c="",s=t;for(let o=0;o<l.length;o++){const u=l[o];c=c?`${c}/${u}`:u,s.has(u)||s.set(u,{id:c,name:u,type:"folder",bookmarks:[],subfolders:new Map,path:c});const W=s.get(u);o===l.length-1?W.bookmarks.push(a):(W.subfolders||(W.subfolders=new Map),s=W.subfolders)}}}),Array.from(t.values())},[b]),z=t=>{if(t===0)return k;if(t<=h.length){let a=k;for(let i=0;i<t;i++){const l=h[i],c=a.find(s=>s.name===l);if(c&&c.subfolders)a=Array.from(c.subfolders.values());else return[]}return a}return[]},N=()=>{if(h.length===0)return[];let t=k;for(let i=0;i<h.length-1;i++){const l=h[i],c=t.find(s=>s.name===l);if(c&&c.subfolders)t=Array.from(c.subfolders.values());else return[]}const a=t.find(i=>i.name===h[h.length-1]);return(a==null?void 0:a.bookmarks)||[]},S=(t,a)=>{const i=h.slice(0,a);i.push(t.name),B(i)},j=t=>{if(C)C(t);else try{typeof chrome<"u"&&chrome.tabs?chrome.tabs.create({url:t.url}):window.open(t.url,"_blank","noopener,noreferrer")}catch(a){console.error("Failed to open bookmark URL:",a),window.location.href=t.url}},E=t=>{try{return new URL(t).hostname.replace("www.","").split(".")[0]}catch{return"link"}},A=t=>{try{return`https://www.google.com/s2/favicons?domain=${new URL(t).hostname}&sz=32`}catch{return""}},x=t=>t?new Date(t).toLocaleDateString():"Unknown date",v=[];for(let t=0;t<=h.length;t++){const a=z(t);a.length>0&&v.push(a)}const M=N();return e.jsxs("div",{className:`flex h-full overflow-x-auto ${L}`,children:[v.map((t,a)=>e.jsx("div",{className:`flex-shrink-0 border-r border-slate-200/50 bg-white/30 backdrop-blur-sm ${y==="flattened"?"w-64":M.length>0?"w-36":"w-48"}`,children:e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-xs font-medium text-slate-700 mb-2 truncate",children:a===0?"Categories":h[a-1]||"Folder"}),e.jsx("div",{className:"space-y-1",children:t.map(i=>e.jsx("div",{children:e.jsx("button",{onClick:()=>S(i,a),className:`w-full text-left p-2 rounded-lg hover:bg-slate-100/60 transition-colors ${h[a]===i.name?"bg-blue-50 border border-blue-200":""}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[e.jsxs("svg",{className:"w-3 h-3 text-slate-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"})]}),e.jsx("span",{className:"text-xs font-medium text-slate-900 truncate",children:i.name}),i.bookmarks&&i.bookmarks.length>0&&e.jsx("span",{className:"text-xs text-slate-500 bg-slate-100 px-1.5 py-0.5 rounded-full flex-shrink-0",children:i.bookmarks.length})]}),i.subfolders&&i.subfolders.size>0||i.bookmarks&&i.bookmarks.length>0?e.jsx("svg",{className:"w-3 h-3 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):null]})})},i.id))})]})},a)),M.length>0&&e.jsx("div",{className:"flex-1 min-w-96 border-r border-slate-200/50 bg-white/30 backdrop-blur-sm",children:e.jsxs("div",{className:"p-4 h-full",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 mb-3",children:["Bookmarks (",M.length,")"]}),e.jsxs("div",{className:"grid grid-cols-12 gap-3 mb-3 px-3 py-2 text-xs font-medium text-slate-600 border-b border-slate-200/50",children:[e.jsx("div",{className:"col-span-4",children:"Title"}),e.jsx("div",{className:"col-span-5",children:"Summary"}),e.jsx("div",{className:"col-span-2",children:"Date Added"}),e.jsx("div",{className:"col-span-1",children:"ID"})]}),e.jsx("div",{className:"space-y-2 overflow-y-auto",style:{height:"calc(100% - 80px)"},children:M.map((t,a)=>e.jsxs("div",{onClick:()=>j(t),title:`Click to open: ${t.url}`,className:"group grid grid-cols-12 gap-3 p-3 rounded-lg hover:bg-slate-100/60 transition-colors cursor-pointer border border-transparent hover:border-slate-200",children:[e.jsxs("div",{className:"col-span-4 flex items-center space-x-2 min-w-0",children:[e.jsxs("div",{className:"flex-shrink-0 w-6 h-6 rounded bg-slate-100 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:A(t.url),alt:"",className:"w-4 h-4",onError:i=>{var c;const l=i.target;l.style.display="none",(c=l.nextElementSibling)==null||c.classList.remove("hidden")}}),e.jsx("div",{className:"hidden w-4 h-4 bg-gradient-to-br from-slate-400 to-slate-500 rounded flex items-center justify-center text-white text-xs font-medium",children:E(t.url).charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 truncate group-hover:text-blue-600 transition-colors",children:t.title}),e.jsx("div",{className:"text-xs text-slate-500 truncate",children:E(t.url)})]})]}),e.jsx("div",{className:"col-span-5 text-sm text-slate-600 line-clamp-2 leading-relaxed",children:t.summary||"-"}),e.jsx("div",{className:"col-span-2 text-sm text-slate-500 flex items-center",children:x(t.dateAdded)}),e.jsxs("div",{className:"col-span-1 text-sm font-mono text-slate-500 flex items-center justify-between",children:[e.jsx("span",{children:t.id?`#${t.id.slice(0,6)}`:"-"}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]},t.id||`${t.url}-${a}`))})]})})]})},se=()=>{const[b,C]=g.useState(null),[L,y]=g.useState(!1),[h,B]=g.useState([]),[k,z]=g.useState([]),[N,S]=g.useState(0),[j,E]=g.useState("columns"),[A,x]=g.useState(!1),[v,M]=g.useState(!1),[t,a]=g.useState([]);g.useEffect(()=>{i();const r=async()=>{if(A){console.log("Skipping bookmark sync during categorization...");return}console.log("Bookmark changed, syncing with Chrome bookmarks...");try{await V.syncWithChromeBookmarks(),await i()}catch(n){console.error("Error syncing bookmarks:",n)}};return typeof chrome<"u"&&chrome.bookmarks&&(chrome.bookmarks.onCreated.addListener(r),chrome.bookmarks.onRemoved.addListener(r),chrome.bookmarks.onChanged.addListener(r),chrome.bookmarks.onMoved.addListener(r)),()=>{typeof chrome<"u"&&chrome.bookmarks&&(chrome.bookmarks.onCreated.removeListener(r),chrome.bookmarks.onRemoved.removeListener(r),chrome.bookmarks.onChanged.removeListener(r),chrome.bookmarks.onMoved.removeListener(r))}},[A]);const i=async()=>{const r=await F.get(D.USER_SETTINGS);C(r);const n=await V.getValidCategorizedBookmarks();B(n),z(n);const d=await V.getUncategorized();S(d.length)},l=async()=>{if(b){y(!0),x(!0);try{const r=await V.getUncategorized();if(r.length===0){y(!1),x(!1);return}const n=await V.getBookmarksWithDescriptions(r),d=await _.categorize({persona:b.persona,bookmarks:n,structure:b.structure});if(d.error)throw new Error(d.error);d.data&&(a(d.data),M(!0))}catch(r){console.error("Categorization error:",r),y(!1),x(!1)}}},c=async()=>{M(!1),y(!0),x(!0);try{if(!b){y(!1),x(!1),a([]);return}const r=await F.get(D.CATEGORIZED_BOOKMARKS)||{};t.forEach(n=>{n.id&&(r[n.id]={bookmark:n,categorizedAt:Date.now()})}),await F.set(D.CATEGORIZED_BOOKMARKS,r),await V.organizeBookmarksInChrome(t,b.structure==="flattened"?"flatten":"nested"),await i(),await new Promise(n=>setTimeout(n,1e3))}catch(r){console.error("Error organizing bookmarks:",r)}finally{y(!1),x(!1),a([])}},s=()=>{M(!1),y(!1),x(!1),a([])},o=async()=>{try{if(await F.remove(D.CATEGORIZED_BOOKMARKS),typeof chrome<"u"&&chrome.bookmarks){const r=await V.getAll();for(const n of r)if(n.id&&await V.isInCategorizedFolder(n))try{await chrome.bookmarks.remove(n.id),console.log(`Removed categorized bookmark: ${n.title}`)}catch(w){console.warn(`Failed to remove bookmark ${n.id}:`,w)}try{const d=(await chrome.bookmarks.getSubTree("1"))[0].id,q=(await chrome.bookmarks.getChildren(d)).find($=>$.title==="📚 Categorized Bookmarks");q&&(await chrome.bookmarks.removeTree(q.id),console.log("Removed categorized bookmarks folder"))}catch(n){console.warn("Failed to remove categorized bookmarks folder:",n)}}B([]),z([]),await i(),console.log("Successfully cleared all categorized bookmarks")}catch(r){console.error("Error clearing all bookmarks:",r)}},u=r=>{chrome.tabs.create({url:r.url})},W=r=>{z(r)},p=r=>{const n=["blue","purple","green","orange","pink","indigo"],d=r.split("").reduce((w,q)=>w+q.charCodeAt(0),0);return n[d%n.length]},f=r=>{const n=new Map;r.forEach(w=>{const $=(Array.isArray(w.category)?w.category.join("/"):w.category).split("/").filter(H=>H.trim()!=="");if($.length===0)n.has("Uncategorized")||n.set("Uncategorized",{bookmarks:[],subcategories:new Map}),n.get("Uncategorized").bookmarks.push(w);else{const H=$[0];n.has(H)||n.set(H,{bookmarks:[],subcategories:new Map});const O=n.get(H);if($.length===1)O.bookmarks.push(w);else{let R=O.subcategories;for(let P=1;P<$.length;P++){const U=$[P];P===$.length-1?(R.has(U)||R.set(U,{bookmarks:[],subcategories:new Map}),R.get(U).bookmarks.push(w)):(R.has(U)||R.set(U,{bookmarks:[],subcategories:new Map}),R=R.get(U).subcategories)}}}});const d=[];for(const[w,q]of n)d.push({category:w,bookmarks:q.bookmarks,subcategories:q.subcategories});return d};if(!b)return e.jsx("div",{className:"min-h-screen liquid-gradient-secondary flex items-center justify-center p-6",children:e.jsxs("div",{className:"liquid-card text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 liquid-gradient-primary rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Setup Required"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Please complete the setup in the extension popup first."}),e.jsx(I,{onClick:()=>window.close(),children:"Close"})]})});const m=f(k);return console.log("All bookmarks:",h),console.log("Filtered bookmarks:",k),console.log("Bookmark groups:",m),e.jsxs("div",{className:"min-h-screen liquid-gradient-secondary",children:[e.jsx("div",{className:"liquid-glass border-b border-white/20 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 liquid-gradient-primary rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Bookmark Spaces"}),e.jsxs("p",{className:"text-slate-600",children:["Organized by ",b.persona]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx(I,{variant:"ghost",onClick:async()=>{try{await V.syncWithChromeBookmarks(),await i()}catch(r){console.error("Error syncing:",r)}},disabled:L,children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("title",{children:"Sync bookmarks"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.93 4.93a10 10 0 0114.14 0m0 0V1m0 3.93H17m-1.07 13.07a10 10 0 01-14.14 0m0 0V23m0-3.93H7"})]})})})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx(J,{bookmarks:h||[],onSearchResults:W,className:"w-full max-w-2xl"})}),e.jsx("div",{className:"mb-8 space-y-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("div",{className:"liquid-card py-3 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Uncategorized"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:N})]})]})}),e.jsx("div",{className:"liquid-card py-3 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Categorized"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:h.length})]})]})}),e.jsx("div",{className:"liquid-card py-3 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Spaces"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:m.length})]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{onClick:l,loading:L,disabled:N===0,children:L?"Categorizing...":`Categorize ${N} Bookmarks`}),e.jsx(I,{variant:"outline",onClick:o,disabled:h.length===0,children:"Clear All"})]})]})}),L&&e.jsxs("div",{className:"liquid-card text-center py-12",children:[e.jsx(K,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Analyzing your bookmarks and categorizing them..."})]}),!L&&e.jsx(e.Fragment,{children:k.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-900",children:[j==="spaces"?"Bookmark Spaces":"All Bookmarks"," (",k.length,")"]}),e.jsx("div",{className:"liquid-nav",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs("button",{onClick:()=>E("columns"),className:`liquid-nav-item ${j==="columns"?"active":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),e.jsx("span",{children:"Columns"})]}),e.jsxs("button",{onClick:()=>E("spaces"),className:`liquid-nav-item ${j==="spaces"?"active":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.jsx("span",{children:"Spaces"})]}),e.jsxs("button",{onClick:()=>E("list"),className:`liquid-nav-item ${j==="list"?"active":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),e.jsx("span",{children:"List"})]})]})})]}),j==="columns"?e.jsx("div",{className:"liquid-card h-96",children:e.jsx(ee,{bookmarks:k,onBookmarkClick:u,className:"h-full"})}):j==="spaces"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((r,n)=>e.jsx("div",{className:"liquid-scale-in",style:{animationDelay:`${n*100}ms`},children:e.jsx(T,{title:r.category,bookmarks:r.bookmarks,subcategories:r.subcategories,color:p(r.category),onBookmarkClick:u})},n))}):e.jsx("div",{className:"liquid-card",children:e.jsx("div",{className:"space-y-3",children:k.map((r,n)=>e.jsxs("div",{onClick:()=>u(r),className:"flex items-center space-x-4 p-4 rounded-xl hover:bg-white/60 transition-all duration-200 cursor-pointer group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center",children:e.jsx("img",{src:`https://www.google.com/s2/favicons?domain=${new URL(r.url).hostname}&sz=32`,alt:"",className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 truncate group-hover:text-blue-600 transition-colors",children:r.title}),e.jsx("p",{className:"text-sm text-slate-500 truncate",children:r.url}),e.jsx("p",{className:"text-xs text-slate-400",children:r.category})]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]},r.id||`${r.url}-${n}`))})})]}):e.jsxs("div",{className:"liquid-card text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 text-slate-400",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No bookmarks found"}),e.jsx("p",{className:"text-slate-600",children:N>0?`Click "Categorize Bookmarks" to organize your ${N} bookmarks.`:"All your bookmarks are already categorized!"})]})})]}),e.jsx(G,{isOpen:v,onAccept:c,onDeny:s,categorizedBookmarks:t})]})};function te(){return e.jsx("div",{className:"h-screen w-full",children:e.jsx(se,{})})}Z.createRoot(document.getElementById("root")).render(e.jsx(Y.StrictMode,{children:e.jsx(te,{})}));
