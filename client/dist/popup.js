import{r as c,j as e,d as S,B as j,C as g,S as f,a as p,b,L as y,P as z,e as B}from"./chunks/index.CzENbDGc.js";const P=t=>{const[s,r]=c.useState(1),[a,o]=c.useState(""),[i,l]=c.useState("nested");return{step:s,setStep:r,persona:a,setPersona:o,structure:i,setStructure:l,handleNext:()=>{s===1&&a.trim()&&r(2)},handleComplete:()=>{a.trim()&&t({persona:a.trim(),structure:i,setupCompleted:!0})},handleBack:()=>{s===2&&r(1)}}},D=()=>e.jsx("div",{className:"liquid-glass border-b border-white/20",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 mx-auto mb-3 liquid-gradient-primary rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-1",children:"Welcome to Bookmark Categorizer"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Let's set up your preferences"})]})})}),C=c.forwardRef(({className:t,type:s,...r},a)=>e.jsx("input",{type:s,className:S("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...r}));C.displayName="Input";const E=({persona:t,setPersona:s,onNext:r})=>e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 mb-2 text-sm",children:"Step 1: Your Persona"}),e.jsx("p",{className:"text-xs text-slate-600 mb-3",children:"Describe your interests as comma-separated values. This helps categorize bookmarks more accurately."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Your Interests"}),e.jsx(C,{value:t,onChange:a=>s(a.target.value),placeholder:"e.g., React, AI, Marketing, Design, Finance",autoFocus:!0,className:"text-sm"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:'Example: "Software Development, React, TypeScript, AI, Machine Learning"'})]}),e.jsx("div",{className:"flex justify-end pt-3",children:e.jsx(j,{onClick:r,disabled:!t.trim(),className:"text-sm py-2",children:"Next"})})]}),A=({structure:t,setStructure:s,onBack:r,onComplete:a})=>e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 mb-2 text-sm",children:"Step 2: Category Structure"}),e.jsx("p",{className:"text-xs text-slate-600 mb-3",children:"Choose how you want your bookmarks to be organized."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"structure",value:"nested",checked:t==="nested",onChange:()=>s("nested"),className:"mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 text-sm",children:"Nested Categories"}),e.jsx("div",{className:"text-xs text-slate-600",children:'Organize in folders like "Development/Frontend/React"'})]})]}),e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"structure",value:"flattened",checked:t==="flattened",onChange:()=>s("flattened"),className:"mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 text-sm",children:"Flattened Categories"}),e.jsx("div",{className:"text-xs text-slate-600",children:'Simple categories like "React", "AI", "Design"'})]})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-3",children:[e.jsx(j,{variant:"ghost",onClick:r,className:"text-sm py-2",children:"Back"}),e.jsx(j,{onClick:a,className:"text-sm py-2",children:"Complete Setup"})]})]}),N=({onComplete:t})=>{const{step:s,persona:r,setPersona:a,structure:o,setStructure:i,handleNext:l,handleComplete:m,handleBack:x}=P(t);return e.jsxs("div",{className:"h-full liquid-gradient-secondary overflow-y-auto",children:[e.jsx(D,{}),s===1&&e.jsx(E,{persona:r,setPersona:a,onNext:l}),s===2&&e.jsx(A,{structure:o,setStructure:i,onBack:x,onComplete:m})]})},O=()=>{const[t,s]=c.useState(null),[r,a]=c.useState(!1),[o,i]=c.useState(0),[l,m]=c.useState(0),[x,h]=c.useState(!1);c.useEffect(()=>{n()},[]);const n=async()=>{const d=await g.get(f.USER_SETTINGS);s(d),await p.syncWithChromeBookmarks();const k=await p.getValidCategorizedBookmarks();i(k.length);const v=await p.getUncategorized();m(v.length)};return{settings:t,setSettings:s,isLoading:r,setIsLoading:a,categorizedCount:o,setCategorizedCount:i,uncategorizedCount:l,setUncategorizedCount:m,showSettings:x,setShowSettings:h,loadData:n,handleSetupComplete:async d=>{await g.set(f.USER_SETTINGS,d),s(d),h(!1)}}},R=(t,s,r)=>{const[a,o]=c.useState(!1),[i,l]=c.useState([]);return{previewOpen:a,previewBookmarks:i,handleCategorizeBookmarks:async()=>{if(t){s(!0);try{const n=await p.getUncategorized();if(n.length===0){s(!1);return}const u=await p.getBookmarksWithDescriptions(n),d=await b.categorize({persona:t.persona,bookmarks:u,structure:t.structure});if(d.error)throw new Error(d.error);d.data&&(l(d.data),o(!0))}catch(n){console.error("Categorization error:",n),s(!1)}}},handleAcceptPreview:async()=>{o(!1),s(!0);try{if(!t){s(!1),l([]);return}const n=await g.get(f.CATEGORIZED_BOOKMARKS)||{};i.forEach(u=>{u.id&&(n[u.id]={bookmark:u,categorizedAt:Date.now()})}),await g.set(f.CATEGORIZED_BOOKMARKS,n),await p.organizeBookmarksInChrome(i,t.structure==="flattened"?"flatten":"nested"),await r()}catch(n){console.error("Error organizing bookmarks:",n)}finally{s(!1),l([])}},handleDenyPreview:()=>{o(!1),s(!1),l([])}}},W=({persona:t,onSettingsClick:s})=>e.jsx("div",{className:"liquid-glass border-b border-white/20",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 liquid-gradient-primary rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-bold text-slate-900",children:"Bookmark Categorizer"}),e.jsx("p",{className:"text-xs text-slate-600",children:t})]})]}),e.jsx("button",{onClick:s,className:"p-1 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})})}),M=({categorizedCount:t,uncategorizedCount:s})=>e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"liquid-card p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:t}),e.jsx("div",{className:"text-xs text-slate-600",children:"Categorized"})]}),e.jsxs("div",{className:"liquid-card p-3 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:s}),e.jsx("div",{className:"text-xs text-slate-600",children:"Uncategorized"})]})]}),q=({isLoading:t,uncategorizedCount:s,onCategorize:r,onOpenDashboard:a,disableCategorize:o})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs(j,{onClick:r,disabled:o,className:"w-full text-sm py-2.5 shadow-lg",children:[t?e.jsx(y,{size:"sm",className:"mr-2"}):null,t?"Categorizing...":`Categorize ${s} Bookmarks`]}),e.jsx(j,{onClick:a,variant:"outline",className:"w-full text-sm py-2.5",children:"Open Dashboard"})]}),I=({structure:t})=>e.jsx("div",{className:"liquid-card p-3",children:e.jsxs("div",{className:"text-xs text-slate-600",children:[e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Structure:"})," ",t]}),e.jsx("p",{children:"Bookmarks are automatically organized in Chrome's native bookmark system."})]})}),L=()=>{const{settings:t,isLoading:s,setIsLoading:r,categorizedCount:a,uncategorizedCount:o,showSettings:i,setShowSettings:l,loadData:m,handleSetupComplete:x}=O(),{previewOpen:h,previewBookmarks:n,handleCategorizeBookmarks:u,handleAcceptPreview:d,handleDenyPreview:k}=R(t,r,m),v=()=>{chrome.tabs.create({url:chrome.runtime.getURL("dashboard.html")})};return t?i?e.jsx("div",{className:"w-80 h-96 liquid-gradient-secondary rounded-sm",children:e.jsx(N,{onComplete:x})}):e.jsxs("div",{className:"w-80 h-96 liquid-gradient-secondary rounded-sm",children:[e.jsx(W,{persona:t.persona,onSettingsClick:()=>l(!0)}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(M,{categorizedCount:a,uncategorizedCount:o}),e.jsx(q,{isLoading:s,uncategorizedCount:o,onCategorize:u,onOpenDashboard:v,disableCategorize:s||o===0}),e.jsx(I,{structure:t.structure}),e.jsx(z,{isOpen:h,onAccept:d,onDeny:k,categorizedBookmarks:n})]})]}):e.jsx("div",{className:"w-80 h-96 liquid-gradient-secondary rounded-sm",children:e.jsx(N,{onComplete:x})})},w=document.getElementById("popup-root");w&&B(w).render(e.jsx(L,{}));
